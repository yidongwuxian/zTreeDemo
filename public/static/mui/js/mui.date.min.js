mui.init();
(function(){
	/*选择日期*/
	function add7Days(dt){
		return new Date((dt/1000+86400*7)*1000);
	}
	function loadDatePicker(){
		var now = new Date();
		var picker = new mui.DtPicker({
			type:"date",
			beginDate:now,
			endDate:add7Days(now)
		});
		picker.show(function(rs) {
			$('#chooseDateTxt').val(rs.text);
			//picker.dispose();
		});
	}
	
	document.getElementById('chooseDateTxt').addEventListener('tap',function(){
		loadDatePicker();
	});

	/*选择区间*/
	function getRangeData(){
		var data = [],
			roots = [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23];
		roots.forEach(function(item){
			var cloned = [].slice.call(roots);
			cloned.splice(0,item+1);
			cloned.push(24);
			data.push({
				value: item,
				text: item + ':00',
				children: (function(){
					var obj = [];
					cloned.forEach(function(it){
						obj.push({
							value: it,
							text: it + ':00'
						})
					})
					return obj;
				})()
			});
		})
		return data;
	}
//console.log(getRangeData());
	var rangePicker = new mui.PopPicker({
		layer: 2
	});
	rangePicker.setData(getRangeData());
	rangePicker.pickers[0].setSelectedValue(8);
//rangePicker.pickers[1].setSelectedValue(9);
	document.getElementById('chooseRangeTxt').addEventListener('tap',function(){
		rangePicker.show(function(items) {$('input').blur();
			$('#chooseRangeTxt').val(items[0].text+ '-' + items[1].text);
			//返回 false 可以阻止选择框的关闭
			//return false;
		});
	});

})();
